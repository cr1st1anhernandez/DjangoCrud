{% extends 'base.html' %}

{% block title %}Detalle de Venta #{{ sale.ticket_number }}{% endblock %}

{% block content %}
<div class="max-w-5xl mx-auto">
    <!-- Botón volver -->
    <div class="mb-8">
        <a href="{% url 'sale_list' %}" class="flex items-center text-base transition-colors" style="color: var(--soft-gray);"
           onmouseover="this.style.color='var(--dark-brown)'"
           onmouseout="this.style.color='var(--soft-gray)'">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
            </svg>
            Volver a Ventas
        </a>
    </div>

    <!-- Header -->
    <div class="mb-12">
        <h1 class="editorial-title mb-3" style="color: var(--dark-brown);">Detalle de Venta</h1>
        <p class="font-mono text-xl" style="color: var(--soft-gray); letter-spacing: 1px;">{{ sale.ticket_number }}</p>
    </div>

    <!-- Contenido Principal -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-12">
        <!-- Información General -->
        <div class="minimal-card p-8">
            <h2 class="serif text-2xl mb-8" style="color: var(--dark-brown); font-weight: 400; letter-spacing: 1px;">
                Información General
            </h2>

            <div class="space-y-6">
                <div>
                    <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                        Número de Ticket
                    </p>
                    <p class="font-mono text-base" style="color: var(--dark-brown); letter-spacing: 0.5px;">
                        {{ sale.ticket_number }}
                    </p>
                </div>

                <div class="grid grid-cols-2 gap-6">
                    <div>
                        <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                            Fecha
                        </p>
                        <p class="text-base" style="color: var(--dark-brown);">
                            {{ sale.created_at|date:"d/m/Y" }}
                        </p>
                    </div>
                    <div>
                        <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                            Hora
                        </p>
                        <p class="text-base" style="color: var(--dark-brown);">
                            {{ sale.created_at|date:"H:i" }}
                        </p>
                    </div>
                </div>

                <div>
                    <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                        Vendedor
                    </p>
                    <p class="text-base" style="color: var(--dark-brown);">
                        {{ sale.user.username }}
                    </p>
                </div>
            </div>
        </div>

        <!-- Resumen -->
        <div class="minimal-card p-8" style="background-color: var(--ivory);">
            <h2 class="serif text-2xl mb-8" style="color: var(--dark-brown); font-weight: 400; letter-spacing: 1px;">
                Resumen
            </h2>

            <div class="space-y-8">
                <div class="p-6 rounded" style="background-color: white; border: 1px solid var(--beige);">
                    <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1px; text-transform: uppercase;">
                        Total de Items
                    </p>
                    <p class="text-2xl font-medium" style="color: var(--dark-brown);">
                        {{ sale.get_items_count }}
                    </p>
                </div>

                <div class="p-6 rounded" style="background-color: white; border: 1px solid var(--beige);">
                    <p class="text-xs mb-3" style="color: var(--soft-gray); letter-spacing: 1px; text-transform: uppercase;">
                        Total de Venta
                    </p>
                    <p class="serif" style="color: var(--gold-accent); font-size: 3rem; font-weight: 500; line-height: 1;">
                        ${{ sale.total }}
                    </p>
                </div>
            </div>
        </div>
    </div>

    <!-- Productos Vendidos -->
    <div class="minimal-card p-8 mb-12">
        <h2 class="serif text-2xl mb-8" style="color: var(--dark-brown); font-weight: 400; letter-spacing: 1px;">
            Productos Vendidos
        </h2>

        <div class="space-y-6">
            {% for item in sale.items.all %}
            <div class="p-6 rounded" style="background-color: var(--ivory); border: 1px solid var(--beige);">
                <div class="flex justify-between items-start mb-4">
                    <div class="flex-1">
                        <p class="text-xs mb-1" style="color: var(--soft-gray); letter-spacing: 1px; text-transform: uppercase;">
                            {{ item.product_brand }}
                        </p>
                        <h3 class="serif text-xl mb-2" style="color: var(--dark-brown); font-weight: 400; letter-spacing: 0.5px;">
                            {{ item.product_name }}
                        </h3>
                        <p class="text-xs font-mono" style="color: var(--soft-gray);">
                            SKU: {{ item.product_sku }}
                        </p>
                    </div>
                </div>

                <div class="flex justify-between items-center pt-4" style="border-top: 1px solid var(--beige);">
                    <div class="flex items-center space-x-6">
                        <div>
                            <p class="text-xs mb-1" style="color: var(--soft-gray);">Cantidad</p>
                            <p class="text-base font-medium" style="color: var(--dark-brown);">{{ item.quantity }}</p>
                        </div>
                        <span style="color: var(--beige);">×</span>
                        <div>
                            <p class="text-xs mb-1" style="color: var(--soft-gray);">Precio</p>
                            <p class="text-base font-medium" style="color: var(--dark-brown);">${{ item.unit_price }}</p>
                        </div>
                    </div>
                    <div class="text-right">
                        <p class="text-xs mb-1" style="color: var(--soft-gray); letter-spacing: 1px;">Subtotal</p>
                        <p class="serif text-2xl" style="color: var(--gold-accent); font-weight: 500;">
                            ${{ item.subtotal }}
                        </p>
                    </div>
                </div>
            </div>
            {% endfor %}
        </div>
    </div>

    <!-- Botones de acción -->
    <div class="flex flex-col md:flex-row gap-4">
        <a href="{% url 'sale_ticket' sale.pk %}"
           class="minimal-btn flex-1 px-6 py-4 rounded text-center text-lg"
           style="background-color: var(--soft-brown); color: white;">
            Ver Ticket Completo
        </a>
        <button onclick="window.print()"
                class="minimal-btn flex-1 px-6 py-4 rounded text-lg"
                style="background-color: var(--ivory); color: var(--dark-brown); border: 1px solid var(--beige);">
            Imprimir
        </button>
    </div>
</div>

<!-- Estilos para impresión -->
<style media="print">
    nav, footer, button, a[href] {
        display: none !important;
    }

    body {
        background: white !important;
    }

    * {
        -webkit-print-color-adjust: exact !important;
        print-color-adjust: exact !important;
    }
</style>
{% endblock %}
