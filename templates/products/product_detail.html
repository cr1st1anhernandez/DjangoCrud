{% extends 'base.html' %}

{% block title %}{{ product.name }} - {{ product.brand }}{% endblock %}

{% block content %}
<div class="max-w-6xl mx-auto">
    <!-- Botón volver -->
    <div class="mb-8">
        <a href="{% url 'product_list' %}" class="flex items-center text-base transition-colors" style="color: var(--soft-gray);"
           onmouseover="this.style.color='var(--dark-brown)'"
           onmouseout="this.style.color='var(--soft-gray)'">
            <svg class="w-5 h-5 mr-2" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="1.5" d="M10 19l-7-7m0 0l7-7m-7 7h18"/>
            </svg>
            Volver al catálogo
        </a>
    </div>

    <!-- Header del Producto -->
    <div class="minimal-card overflow-hidden mb-8">
        <div class="p-12" style="background-color: var(--ivory);">
            <div class="flex items-start justify-between">
                <div class="flex-1">
                    <p class="text-xs mb-3" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                        {{ product.brand }}
                    </p>
                    <h1 class="editorial-title mb-4" style="color: var(--dark-brown);">
                        {{ product.name }}
                    </h1>
                    <p class="text-base max-w-2xl" style="color: var(--soft-gray); letter-spacing: 0.3px;">
                        {{ product.description }}
                    </p>
                </div>

                <!-- Imagen o Ícono -->
                {% if product.image %}
                <div class="ml-12">
                    <img src="{{ product.image.url }}" alt="{{ product.name }}" class="w-48 h-48 object-cover rounded">
                </div>
                {% else %}
                <div class="ml-12 w-48 h-48 flex items-center justify-center rounded" style="background-color: white; border: 1px solid var(--beige);">
                    <svg class="w-24 h-24" style="color: var(--beige);" fill="currentColor" viewBox="0 0 24 24">
                        <path d="M9 3h6v2h2a2 2 0 012 2v12a2 2 0 01-2 2H7a2 2 0 01-2-2V7a2 2 0 012-2h2V3zm6 4H9v1h6V7zm-6 3v8h6v-8H9z"/>
                    </svg>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Grid de Información -->
    <div class="grid grid-cols-1 lg:grid-cols-2 gap-8 mb-8">
        <!-- Columna Izquierda: Información General -->
        <div class="space-y-8">
            <!-- Categorización -->
            <div class="minimal-card p-8">
                <h2 class="serif text-2xl mb-8" style="color: var(--dark-brown); font-weight: 400; letter-spacing: 1px;">
                    Categorización
                </h2>

                <div class="space-y-6">
                    <div class="grid grid-cols-2 gap-6">
                        <div>
                            <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                                Categoría
                            </p>
                            <span class="inline-block px-3 py-1 rounded text-sm" style="background-color: var(--beige); color: var(--soft-brown);">
                                {{ product.get_category_display }}
                            </span>
                        </div>
                        <div>
                            <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                                Género
                            </p>
                            <span class="inline-block px-3 py-1 rounded text-sm" style="background-color: var(--beige); color: var(--soft-brown);">
                                {% if product.gender == 'M' %}Masculino
                                {% elif product.gender == 'F' %}Femenino
                                {% else %}Unisex{% endif %}
                            </span>
                        </div>
                    </div>

                    {% if product.fragrance_type %}
                    <div>
                        <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                            Tipo de Fragancia
                        </p>
                        <span class="inline-block px-3 py-1 rounded text-sm" style="background-color: var(--ivory); color: var(--dark-brown); border: 1px solid var(--beige);">
                            {{ product.get_fragrance_type_display }}
                        </span>
                    </div>
                    {% endif %}

                    <div>
                        <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                            Volumen
                        </p>
                        <p class="serif text-2xl" style="color: var(--dark-brown); font-weight: 500;">
                            {{ product.volume }} ml
                        </p>
                    </div>
                </div>
            </div>

            <!-- Identificadores -->
            <div class="minimal-card p-8">
                <h2 class="serif text-2xl mb-8" style="color: var(--dark-brown); font-weight: 400; letter-spacing: 1px;">
                    Identificadores
                </h2>

                <div class="space-y-6">
                    <div>
                        <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                            SKU
                        </p>
                        <p class="text-base font-mono" style="color: var(--dark-brown);">
                            {{ product.sku }}
                        </p>
                    </div>

                    {% if product.barcode %}
                    <div>
                        <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                            Código de Barras
                        </p>
                        <p class="text-base font-mono" style="color: var(--dark-brown);">
                            {{ product.barcode }}
                        </p>
                    </div>
                    {% endif %}

                    {% if product.supplier %}
                    <div>
                        <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                            Proveedor
                        </p>
                        <p class="text-base" style="color: var(--dark-brown);">
                            {{ product.supplier }}
                        </p>
                    </div>
                    {% endif %}
                </div>
            </div>
        </div>

        <!-- Columna Derecha: Precios e Inventario -->
        <div class="space-y-8">
            <!-- Precios -->
            <div class="minimal-card p-8" style="background-color: var(--ivory);">
                <h2 class="serif text-2xl mb-8" style="color: var(--dark-brown); font-weight: 400; letter-spacing: 1px;">
                    Precios e Inventario
                </h2>

                <div class="space-y-6">
                    <!-- Precio de Venta -->
                    <div class="p-6 rounded" style="background-color: white; border: 1px solid var(--beige);">
                        <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1px; text-transform: uppercase;">
                            Precio de Venta
                        </p>
                        <p class="serif" style="color: var(--gold-accent); font-size: 3rem; font-weight: 500; line-height: 1;">
                            ${{ product.price }}
                        </p>
                    </div>

                    <!-- Costo y Margen -->
                    {% if product.cost > 0 %}
                    <div class="p-6 rounded" style="background-color: white; border: 1px solid var(--beige);">
                        <div class="flex justify-between items-start mb-4">
                            <div>
                                <p class="text-xs mb-1" style="color: var(--soft-gray); letter-spacing: 1px; text-transform: uppercase;">
                                    Costo
                                </p>
                                <p class="serif text-2xl" style="color: var(--soft-brown); font-weight: 500;">
                                    ${{ product.cost }}
                                </p>
                            </div>
                            <div class="text-right">
                                <p class="text-xs mb-1" style="color: var(--soft-gray); letter-spacing: 1px; text-transform: uppercase;">
                                    Margen
                                </p>
                                <p class="serif text-2xl" style="color: var(--dark-brown); font-weight: 500;">
                                    {{ product.profit_margin|floatformat:2 }}%
                                </p>
                            </div>
                        </div>
                        <p class="text-sm" style="color: var(--soft-gray);">
                            Ganancia por unidad: ${{ product.price|add:"-"|add:product.cost|floatformat:2 }}
                        </p>
                    </div>
                    {% endif %}

                    <!-- Stock -->
                    <div class="p-6 rounded" style="background-color: white; border: 1px solid var(--beige);">
                        <div class="grid grid-cols-2 gap-6">
                            <div>
                                <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1px; text-transform: uppercase;">
                                    Stock Actual
                                </p>
                                <p class="serif text-3xl" style="color: {% if product.is_low_stock %}#DC2626{% else %}var(--dark-brown){% endif %}; font-weight: 500;">
                                    {{ product.quantity }}
                                </p>
                                {% if product.is_low_stock %}
                                <p class="text-xs mt-1" style="color: #DC2626; letter-spacing: 0.5px;">
                                    STOCK BAJO
                                </p>
                                {% endif %}
                            </div>
                            <div>
                                <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1px; text-transform: uppercase;">
                                    Stock Mínimo
                                </p>
                                <p class="serif text-3xl" style="color: var(--dark-brown); font-weight: 500;">
                                    {{ product.min_stock }}
                                </p>
                            </div>
                        </div>
                    </div>

                    <!-- Alerta de Stock Bajo -->
                    {% if product.is_low_stock %}
                    <div class="p-4 rounded" style="background-color: rgba(220, 38, 38, 0.05); border: 1px solid rgba(220, 38, 38, 0.2);">
                        <div class="flex items-start">
                            <svg class="w-5 h-5 mr-3 flex-shrink-0" style="color: #DC2626;" fill="none" stroke="currentColor" viewBox="0 0 24 24">
                                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 9v2m0 4h.01m-6.938 4h13.856c1.54 0 2.502-1.667 1.732-3L13.732 4c-.77-1.333-2.694-1.333-3.464 0L3.34 16c-.77 1.333.192 3 1.732 3z"/>
                            </svg>
                            <div>
                                <p class="text-sm font-medium mb-1" style="color: #DC2626;">
                                    Alerta de Stock Bajo
                                </p>
                                <p class="text-xs" style="color: var(--soft-gray);">
                                    El stock está en o por debajo del mínimo. Considere realizar un pedido.
                                </p>
                            </div>
                        </div>
                    </div>
                    {% endif %}
                </div>
            </div>

            <!-- Información Adicional -->
            <div class="minimal-card p-8">
                <h2 class="serif text-2xl mb-8" style="color: var(--dark-brown); font-weight: 400; letter-spacing: 1px;">
                    Información Adicional
                </h2>

                <div class="space-y-6">
                    {% if product.expiration_date %}
                    <div>
                        <p class="text-xs mb-2" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                            Fecha de Vencimiento
                        </p>
                        <p class="text-lg" style="color: var(--dark-brown);">
                            {{ product.expiration_date|date:"d/m/Y" }}
                        </p>
                    </div>
                    {% endif %}

                    <div class="pt-6" style="border-top: 1px solid var(--beige);">
                        <p class="text-xs mb-3" style="color: var(--soft-gray); letter-spacing: 1.5px; text-transform: uppercase;">
                            Metadatos del Sistema
                        </p>
                        <div class="space-y-2 text-sm" style="color: var(--soft-gray);">
                            <p>
                                <span class="font-medium">Creado:</span> {{ product.created_at|date:"d/m/Y H:i" }}
                            </p>
                            <p>
                                <span class="font-medium">Última actualización:</span> {{ product.updated_at|date:"d/m/Y H:i" }}
                            </p>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Botones de Acción -->
    <div class="flex flex-col md:flex-row gap-4">
        <a href="{% url 'product_edit' product.pk %}"
           class="minimal-btn flex-1 px-6 py-4 rounded text-center text-lg"
           style="background-color: var(--soft-brown); color: white;">
            Editar Producto
        </a>
        <a href="{% url 'product_delete' product.pk %}"
           class="minimal-btn flex-1 px-6 py-4 rounded text-center text-lg"
           style="background-color: var(--ivory); color: #DC2626; border: 1px solid rgba(220, 38, 38, 0.3);">
            Eliminar Producto
        </a>
    </div>
</div>
{% endblock %}
